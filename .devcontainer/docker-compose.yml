version: '3.8'

services:
  app:
    # Use Java 17 to match pom.xml
    image: mcr.microsoft.com/devcontainers/java:1-17-bullseye
    volumes:
      # Mount workspace
      - ../:/workspace:cached
      # Mount local Maven repository to persist dependencies and avoid re-downloading
      - ~/.m2:/home/vscode/.m2:cached
    
    # Keep container running
    command: /bin/sh -c "while sleep 1000; do :; done"
    
    # Network config
    # network_mode: service:db 

    # Access host services
    extra_hosts:
      - "host.docker.internal:host-gateway"

  # --- Database & Redis placeholders (commented out) ---
  # db:
  #   image: postgres:latest
  #   restart: unless-stopped
  #   environment:
  #     POSTGRES_PASSWORD: cyberpassword
  #   volumes:
  #     - postgres-data:/var/lib/postgresql/data
  
  # redis:
  #   image: redis:alpine
  #   restart: unless-stopped

# volumes:
#   postgres-data: